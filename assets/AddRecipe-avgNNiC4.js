import{H as ee,J as W,r as g,j as e,K as B,I as te,M,P as E,B as F,L as se,Q as re,T as ae,U as ne,V as ie,k as Q,W as oe,X as ce,Y as le,l as de,Z as pe,_ as S,$ as me}from"./index-BmUsl9bo.js";import{B as _e}from"./BreadCrumbs-Bhslelf5.js";import{S as ue}from"./SectionTitle-B5dJojJL.js";import{s as he}from"./profileSelectors-DjL7l0TR.js";const xe=ee().shape({title:W().required("Title is required"),description:W().max(200,"Description must be at most 200 characters").required("Description is required"),category:W().required("Category is required"),area:W().required("Area is required"),instructions:W().max(2e3,"Description must be at most 200 characters").required("Instructions are required")}),ge="_container_lr8wa_1",je="_subheadear_lr8wa_10",be="_breaCrumbs_lr8wa_17",fe="_titleWrapper_lr8wa_21",ye="_titleAndCrumpsWraper_lr8wa_25",Ie="_formWrapper_lr8wa_33",Ne="_form_lr8wa_33",ve="_nameInput_lr8wa_55",We="_nameInputWrapper_lr8wa_69",we="_errorTitle_lr8wa_72",Ce="_errorMsg_lr8wa_81",Te="_textareaWrapper_lr8wa_100",$e="_textarea_lr8wa_100",Se="_labelPrep_lr8wa_122",Ae="_symbolCounter_lr8wa_132",Be="_recipeData_lr8wa_139",Me="_recipeIncstructions_lr8wa_145",De="_buttonWrapper_lr8wa_149",Le="_button_lr8wa_149",Re="_trashBtn_lr8wa_165",ke="_iconTrash_lr8wa_173",qe="_categoryAndTime_lr8wa_207",t={container:ge,subheadear:je,breaCrumbs:be,titleWrapper:fe,titleAndCrumpsWraper:ye,formWrapper:Ie,form:Ne,nameInput:ve,nameInputWrapper:We,errorTitle:we,errorMsg:Ce,textareaWrapper:Te,textarea:$e,labelPrep:Se,symbolCounter:Ae,recipeData:Be,recipeIncstructions:Me,buttonWrapper:De,button:Le,trashBtn:Re,iconTrash:ke,categoryAndTime:qe},Ue="_errorMsg_1sccx_5",Ee="_wrapper_1sccx_11",Qe="_uploadBox_1sccx_20",Pe="_uploadAnotherSpan_1sccx_32",Fe="_customUploadBtn_1sccx_43",Ge="_imagePreview_1sccx_55",He="_btnWrapper_1sccx_65",Je="_photoIcon_1sccx_102",x={errorMsg:Ue,wrapper:Ee,uploadBox:Qe,uploadAnotherSpan:Pe,customUploadBtn:Fe,imagePreview:Ge,btnWrapper:He,photoIcon:Je},Oe=({register:a,setValue:r,imagePreview:c,setImagePreview:d,errors:i,watch:l})=>(g.useEffect(()=>{const o=l(j=>{j.thumb[0]&&(d(URL.createObjectURL(j.thumb[0])),r("thumb",j.thumb[0]))});return()=>o.unsubscribe()},[l,d,r]),e.jsxs("div",{className:x.wrapper,children:[e.jsx("div",{className:x.uploadBox,children:e.jsxs("label",{className:x.customUploadBtn,children:[e.jsx(B,{type:"file",name:"thumb",register:a,setValue:r,errors:i}),c&&e.jsx("img",{src:c,alt:"Recipe Preview",className:x.imagePreview}),e.jsxs("div",{className:x.btnWrapper,children:[!c&&e.jsxs(e.Fragment,{children:[e.jsx(te,{iconId:"icon-capture-photo-camera",width:"50px",height:"50",customStyle:x.photoIcon}),e.jsx("span",{children:"Upload a photo"})]}),i.thumb&&e.jsx("p",{className:x.errorMsg,children:i.thumb.message})]})]})}),c&&e.jsxs("label",{className:x.uploadAnotherSpan,children:[e.jsx(B,{type:"file",name:"thumb",register:a,setValue:r,errors:i}),"Upload another photo"]})]})),ze="_container_192la_1",Ke="_errorMsg_192la_7",Ve="_selectors_time_wrapp_192la_13",Xe="_textareaWrapper_192la_19",Ye="_symbolCounter_192la_23",Ze="_textarea_192la_19",et="_inputQuantity_192la_55",tt="_buttonAdd_192la_79",st="_addBtnIcon_192la_97",rt="_icon_192la_110",at="_list_192la_122",nt="_listItem_192la_128",it="_imageWrapper_192la_135",ot="_image_192la_135",ct="_iconBtn_192la_143",lt="_textWrapper_192la_159",dt="_ingredientAndQuantity_192la_164",s={container:ze,errorMsg:Ke,selectors_time_wrapp:Ve,textareaWrapper:Xe,symbolCounter:Ye,textarea:Ze,inputQuantity:et,buttonAdd:tt,addBtnIcon:st,icon:rt,list:at,listItem:nt,imageWrapper:it,image:ot,iconBtn:ct,textWrapper:lt,ingredientAndQuantity:dt},pt="_iconBtn_1gk00_1",mt="_icon_1gk00_1",_t="_counterInput_1gk00_21",A={iconBtn:pt,icon:mt,counterInput:_t},ut=({cookingTime:a,setCookingTime:r})=>{const c=()=>{r(i=>i+10)},d=()=>{r(i=>i>10?i-10:10)};return e.jsxs("div",{children:[e.jsx("label",{children:"Cooking Time"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx(M,{iconId:"icon-minus",width:"16",height:"16",type:"button",style:A.iconBtn,styleSVG:A.icon,onClick:d}),e.jsx("div",{children:e.jsxs("span",{style:{margin:"0 12px"},children:[a," min"]})}),e.jsx(M,{iconId:"icon-plus",type:"button",width:"16",height:"16",style:A.iconBtn,styleSVG:A.icon,onClick:c})]})]})},ht="_form__group_1d152_1",xt="_form__field_1d152_8",gt="_form__label_1d152_28",m={form__group:ht,form__field:xt,form__label:gt},G=a=>{g.useEffect(()=>{const r=document.querySelector(`.${a}`),c=d=>{r.style.height="36px",r.style.height=`${d.target.scrollHeight}px`};return r.addEventListener("input",c),()=>{r.removeEventListener("input",c)}},[a])},jt=({register:a,setValue:r,watch:c,ingredients:d,selectedIngredients:i,setSelectedIngredients:l,errors:o,categories:j,areas:w,cookingTime:b,setCookingTime:D,isIngredientsLoading:y,isCategoriesLoading:L,isAreasLoading:R})=>{var N;const[k,C]=g.useState(!1),f=c("ingredient"),T=c("measure"),q=()=>{if(f&&T){const n=d.find(h=>h._id===f.value);l([...i,{id:f.value,measure:T,imageUrl:n.img,label:f.label}]),r("ingredient",null),r("measure",""),C(!0)}},U=n=>{l(i.filter((h,$)=>$!==n)),i.length<=1&&C(!1)},I=n=>n?e.jsx(se,{}):null;return G(s.textarea),e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:`${m.form__group} ${m.field}`,children:[e.jsx("textarea",{...a("description"),name:"description",maxLength:"200",placeholder:"Enter the description of the dish",id:"description",className:`${m.form__field} ${s.textarea}`,required:!0}),e.jsx("label",{htmlFor:"description",className:m.form__label,children:"Enter the description of the dish"}),e.jsxs("span",{className:s.symbolCounter,children:[((N=c("description"))==null?void 0:N.length)||0,"/200"]})]}),o.description&&e.jsx("p",{className:s.errorMsg,children:o.description.message}),e.jsxs("div",{className:s.selectors_time_wrapp,children:[e.jsx("div",{className:s.categoryAndTime,children:I(L)||e.jsxs("div",{children:[e.jsx("label",{children:"Category"}),e.jsx(E,{options:j,placeholder:"Select a category",...a("category"),onChange:n=>r("category",n.label)}),o.category&&e.jsx("p",{className:s.errorMsg,children:o.category.message})]})}),e.jsxs("div",{children:[e.jsx(ut,{cookingTime:b,setCookingTime:D}),o.cookingTime&&e.jsx("p",{className:s.errorMsg,children:o.cookingTime.message})]})]}),e.jsx("div",{className:s.categoryAndTime,children:I(R)||e.jsxs("div",{children:[e.jsx("label",{children:"Area"}),e.jsx(E,{options:w,placeholder:"Select area",...a("area"),onChange:n=>r("area",n.label)}),o.area&&e.jsx("p",{className:s.errorMsg,children:o.area.message})]})}),e.jsxs("div",{className:s.ingredientAndQuantity,children:[y?e.jsx("p",{children:"Loading..."}):e.jsxs("div",{children:[e.jsx("label",{children:"Ingredient"}),e.jsx(E,{options:d,placeholder:"Select an ingredient",className:s.select,...a("ingredient"),onChange:n=>r("ingredient",n)}),o.ingredient&&e.jsx("p",{className:s.errorMsg,children:o.ingredient.message})]}),e.jsxs("div",{className:`${m.form__group} ${m.field}`,children:[e.jsx(B,{type:"text",name:"measure",id:"measure",register:a,placeholder:"Enter quantity",classname:`${s.inputQuantity} ${m.form__field}`}),e.jsx("label",{className:m.form__label,htmlFor:"measure",children:"Enter quantity"}),o.measure&&e.jsx("p",{className:s.errorMsg,children:o.measure.message})]})]}),k&&e.jsx("ul",{className:s.list,children:i.map((n,h)=>e.jsxs("li",{className:s.listItem,children:[e.jsx("div",{className:s.imageWrapper,children:e.jsx("img",{src:n.imageUrl,alt:n.label,width:"55px",height:"55px",className:s.image})}),e.jsxs("div",{className:s.textWrapper,children:[e.jsx("p",{children:n.label}),e.jsx("p",{children:n.measure})]}),e.jsx(M,{iconId:"icon-close-btn",type:"button",onClick:()=>U(h),style:s.iconBtn})]},h))}),e.jsx(F,{text:"Add ingredient",type:"button",onClick:q,iconId:"icon-plus",iconStyle:s.addBtnIcon,classname:s.buttonAdd})]})},bt="_formTitleWrapper_17dnn_1",ft="_fromDescription_17dnn_19",yt="_formTitle_17dnn_1",P={formTitleWrapper:bt,fromDescription:ft,formTitle:yt},It=()=>e.jsx("div",{className:P.formTitleWrapper,children:e.jsx("p",{className:P.fromDescription,children:"Reveal your culinary art, share your favorite recipe and create gastronomic masterpieces with us."})}),Ct=()=>{const{register:a,handleSubmit:r,control:c,setValue:d,watch:i,formState:{errors:l},reset:o}=re({resolver:pe(xe),defaultValues:{selectedIngredients:[]}}),[j,w]=g.useState(0),b=200,D=u=>{const v=u.target.value.trim().split(/\s+/).filter(p=>p.length>0);if(v.length<=b)w(v.length);else{const p=v.slice(0,b).join(" ");u.target.value=p,w(b),S.error(`max length ${b} words`)}},y="addRecipeToastId",{data:L,isLoading:R}=ae(),{data:k,isLoading:C}=ne(),{data:f,isLoading:T}=ie(),[q]=g.useState(Q(oe)),[U]=ce(),[I,N]=g.useState([]),[n,h]=g.useState(null),[$,H]=g.useState(10),J=Q(he),O=le(),z=L,K=k,V=f,X=de(),Y=async u=>{const _=new FormData;_.append("thumb",u.thumb),_.append("title",u.title),_.append("description",u.description),_.append("category",u.category),_.append("area",u.area),_.append("time",$.toString()),_.append("instructions",u.instructions);const v=I.map(p=>({id:p.id,measure:p.measure}));_.append("ingredients",JSON.stringify(v));try{const p=await U(_);p.error?S.error(p.error.data.message,{toastId:y}):(O(me([...J,p.data.data])),X(`/user/${q}`),S.success("Recipe added",{toastId:y}),o())}catch(p){S.error(p.message,{toastId:y})}},Z=()=>{o(),h(null),N([])};return G(t.textarea),e.jsxs("div",{className:t.container,children:[e.jsxs("div",{className:t.titleAndCrumpsWraper,children:[e.jsx("div",{className:t.breaCrumbs,children:e.jsx(_e,{currentPage:"Add Recipe"})}),e.jsxs("div",{className:t.titleWrapper,children:[e.jsx(ue,{text:"add recipe"}),e.jsx(It,{})]})]}),e.jsx("form",{onSubmit:r(Y),className:t.form,children:e.jsxs("div",{className:t.formWrapper,children:[e.jsx(Oe,{register:a,setValue:d,imagePreview:n,setImagePreview:h,watch:i,errors:l}),e.jsxs("div",{children:[e.jsxs("div",{className:t.nameInputWrapper,children:[e.jsx(B,{type:"text",name:"title",register:a,placeholder:"The name of the recipe",classname:t.nameInput}),l.title&&e.jsx("p",{className:t.errorTitle,children:l.title.message})]}),e.jsx("div",{className:t.recipeData,children:e.jsx("div",{className:t.categoryAndTime,children:e.jsxs("div",{className:t.recipeData,children:[e.jsx(jt,{control:c,register:a,setValue:d,watch:i,categories:z,areas:V,cookingTime:$,setCookingTime:H,ingredients:K,selectedIngredients:I,setSelectedIngredients:N,errors:l,isCategoriesLoading:R,isIngredientsLoading:C,isAreasLoading:T}),l.selectedIngredients&&e.jsx("p",{className:t.errorMsg,children:l.selectedIngredients.message})]})})}),e.jsxs("div",{className:t.recipeIncstructions,children:[e.jsx("h2",{className:t.subheadear,children:"Recipe preparation"}),e.jsxs("div",{className:`${t.textareaWrapper} ${m.form__group} ${m.field}`,children:[e.jsx("textarea",{...a("instructions"),onInput:D,id:"instructions",name:"instructions",placeholder:"Enter recipe",maxLength:"none",className:`${t.textarea} ${m.form__field}`}),e.jsx("label",{className:`${t.labelPrep} ${m.form__label}`,children:"Enter recipe"}),e.jsxs("span",{className:t.symbolCounter,children:[j,"/",b]}),l.instructions&&e.jsx("p",{className:t.errorMsg,children:l.instructions.message})]})]}),e.jsxs("div",{className:t.buttonWrapper,children:[e.jsx(M,{iconId:"icon-trash",type:"button",onClick:Z,width:"20",height:"20",style:t.trashBtn,styleSVG:t.iconTrash}),e.jsx(F,{text:"Publish",type:"submit",classname:t.button})]})]})]})})]})};export{Ct as default};
