import{j as e,Y as E,k as h,x as H,z as le,a0 as pe,N as J,M as k,$ as X,a1 as de,A as ue,u as Q,W as Z,B as z,F as K,r as u,a2 as _e,a3 as fe,a4 as me,a5 as he,a6 as ge,a7 as we,L as xe,a8 as je,a9 as ve,w as G,v as ye,aa as be,ab as Ce,ac as Ie,ad as Ne,ae as Fe,af as q,ag as Le,_ as U,C as Pe,ah as Re}from"./index-BmUsl9bo.js";import{s as ee,a as B,b as Ue,c as We,d as Se}from"./profileSelectors-DjL7l0TR.js";import{r as Ae}from"./recipe_without_img-B5hcdovh.js";import{S as Te}from"./SectionTitle-B5dJojJL.js";import{B as ke}from"./BreadCrumbs-Bhslelf5.js";const Ee="_container_1pwje_1",Be="_content_1pwje_6",Oe="_message_1pwje_10",y={container:Ee,content:Be,message:Oe},qe="_menuContainer_1kjmf_1",$e="_menuItem_1kjmf_15",Me="_active_1kjmf_38",$={menuContainer:qe,menuItem:$e,active:Me},De=({menuItems:s,activeTab:a,setActiveTab:t})=>e.jsx("div",{className:$.menuContainer,children:s.map(n=>e.jsx("div",{className:`${$.menuItem} ${n.id===a?$.active:""}`,onClick:()=>t(n.id),children:n.label},n.id))}),ze="_recipeCard_cpas5_1",Ve="_recipeImg_cpas5_9",Y={recipeCard:ze,recipeImg:Ve},se=({imgUrl:s,title:a})=>e.jsx("div",{className:Y.recipeCard,children:e.jsx("img",{className:Y.recipeImg,src:s!=="[object FileList]"?s:Ae,alt:a})}),Qe="_recipeCardWrapper_1cu55_1",Ge="_flexPhotoWrapper_1cu55_6",Ye="_recipeTextWrapper_1cu55_11",He="_recipeInstructions_1cu55_15",Je="_recipeTitle_1cu55_26",Xe="_buttonWrapper_1cu55_32",Ze="_recipeCardList_1cu55_37",Ke="_iconBtn_1cu55_43",es="_icon_1cu55_43",x={recipeCardWrapper:Qe,flexPhotoWrapper:Ge,recipeTextWrapper:Ye,recipeInstructions:He,recipeTitle:Je,buttonWrapper:Xe,recipeCardList:Ze,iconBtn:Ke,icon:es},ss=({data:s,tab:a})=>{const t=E(),n=h(H),l=h(ee),p=h(B),[c]=le(),[d]=pe(),_=()=>{a==="recipe"?(t(X(l.filter(f=>f._id!==s._id))),d(s._id)):(t(de(n.filter(f=>f!==s._id))),ue(c,s._id,"delete"))};return e.jsxs("li",{className:x.recipeCardWrapper,children:[e.jsxs("div",{className:x.flexPhotoWrapper,children:[e.jsx(se,{imgUrl:s.thumb,title:s.title}),e.jsxs("div",{className:x.recipeTextWrapper,children:[e.jsxs("h5",{className:x.recipeTitle,children:[" ",s.title," "]}),e.jsx("p",{className:x.recipeInstructions,children:s.instructions})]})]}),e.jsxs("div",{className:x.buttonWrapper,children:[e.jsx(J,{to:`/recipe/${s._id}`,children:e.jsx(k,{iconId:"icon-arrow-up-right",style:x.iconBtn,styleSVG:x.icon})}),p&&e.jsx(k,{iconId:"icon-trash",onClick:_,style:x.iconBtn,styleSVG:x.icon})]})]})},M=({data:s,tab:a})=>e.jsx("ul",{className:x.recipeCardList,children:s.map(t=>e.jsx(ss,{data:t,tab:a},t._id))}),ts="_cardWrapper_9gq3s_1",rs="_photoWrapper_9gq3s_8",os="_smallProfilePhoto_9gq3s_21",as="_followerData_9gq3s_27",ns="_name_9gq3s_33",is="_descr_9gq3s_41",cs="_followerCardList_9gq3s_48",ls="_iconBtn_9gq3s_52",ps="_icon_9gq3s_52",ds="_recipesList_9gq3s_86",us="_recipeCard_9gq3s_93",_s="_link_wrapper_9gq3s_110",j={cardWrapper:ts,photoWrapper:rs,smallProfilePhoto:os,followerData:as,name:ns,descr:is,followerCardList:cs,iconBtn:ls,icon:ps,recipesList:ds,recipeCard:us,link_wrapper:_s},fs=({data:s,tab:a,handleFollowUser:t,handleUnfollowUser:n})=>{var _;const l=Q(768,!1,3),p=Q(1440,3,4),c=h(Z),d=()=>{if(a==="followers")return s.isFollowing?"unfollow":"follow";if(a==="following")return"unfollow"};return e.jsxs("li",{className:j.cardWrapper,children:[e.jsxs("div",{className:j.followerData,children:[e.jsx("img",{src:s.avatarURL||"https://gravatar.com/avatar/000000000000000000000000000000000000000000000000000000?d=mp",className:j.smallProfilePhoto,alt:"User avatar"}),e.jsxs("div",{children:[e.jsxs("h5",{className:j.name,children:[" ",s.name.split(" ")[0]]}),e.jsxs("p",{className:j.descr,children:["Own recipes: ",s.totalRecipes]}),e.jsx(z,{disabled:s._id===c,text:d(),variant:"follow_user",onClick:()=>d()==="follow"?t(s._id):n(s._id)})]})]}),l&&e.jsx("ul",{className:j.recipesList,children:(_=s==null?void 0:s.recipes)==null?void 0:_.map((f,o)=>{if(o<p)return e.jsx("li",{children:e.jsx(se,{imgUrl:f.thumb,title:f.title})},f._id)})}),e.jsx(J,{to:`/user/${s._id}`,className:j.link_wrapper,children:e.jsx(k,{iconId:"icon-arrow-up-right",style:j.iconBtn,styleSVG:j.icon})})]})},D=({data:s,tab:a,handleFollowUser:t,handleUnfollowUser:n})=>e.jsx("ul",{className:j.followerCardList,children:s.map(l=>e.jsx(fs,{data:l,tab:a,handleFollowUser:t,handleUnfollowUser:n},l._id))}),I=[{id:"my-recipes",label:"MY RECIPES",message:"Nothing has been added to your recipes list yet. Please browse our recipes and add your favorites for easy access in the future."},{id:"my-favorites",label:"MY FAVORITES",message:"Nothing has been added to your favorite recipes list yet. Please browse our recipes and add your favorites for easy access in the future."},{id:"followers",label:"FOLLOWERS",message:"There are currently no followers on your account. Please engage our visitors with interesting content and draw their attention to your profile."},{id:"following",label:"FOLLOWING",message:"Your account currently has no subscriptions to other users. Learn more about our users and select those whose content interests you."}],W=[{id:"recipes",label:"RECIPES",message:"The current user hasn't added any recipes yet."},{id:"followers",label:"FOLLOWERS",message:"The current user hasn't any followers yet."}],ms=({handleFollowUser:s,handleUnfollowUser:a})=>{const{id:t}=K(),n=E(),l=h(B),p=h(Ue),c=h(We),d=u.useRef(null),_=h(ee),f=h(H),[o,b]=u.useState(1),[N,i]=u.useState(0),[r,m]=u.useState(l?I[0].id:W[0].id),{data:g,isLoading:w}=_e({userId:t,page:o},{skip:r!=="my-recipes"&&r!=="recipes",refetchOnMountOrArgChange:!0});u.useEffect(()=>{b(1)},[r]);const R=({selected:L})=>{b(L+1),d.current&&d.current.scrollIntoView({behavior:"smooth"})};u.useEffect(()=>{m(l?I[0].id:W[0].id)},[l]);const{data:C,isLoading:te}=fe({page:o,limit:10,skip:r!=="my-favorites"}),{data:A,isLoading:re}=me({userId:t,page:o,skip:r!=="followers"}),{data:T,isLoading:oe}=he({skip:r!=="following",page:o}),ae=w||te||re||oe;u.useEffect(()=>{(r==="my-recipes"||r==="recipes")&&g&&!w&&(i(g.totalPages),n(X(g.data))),r==="followers"&&A?(i(A.totalPages),n(ge(A.followersWithRecipes))):r==="following"&&T?(i(T.totalPages),n(we(T.followingWithRecipes))):r==="my-favorites"&&C&&i(C.totalPages)},[r,n,A,T,C,w,g,o,f]);const F=(L,O)=>L.find(({id:ce})=>ce===O).message,ne=()=>{var L;if(l)switch(r){case"my-recipes":return(_==null?void 0:_.length)>0?e.jsx(M,{data:_,tab:"recipe"}):e.jsx("p",{className:y.message,children:F(I,r)});case"my-favorites":if(((L=C.data)==null?void 0:L.length)>0){const O=C==null?void 0:C.data.map(V=>V.recipe);return e.jsx(M,{data:O,tab:"favorites"})}else return e.jsx("p",{className:y.message,children:F(I,r)});case"followers":return(p==null?void 0:p.length)>0?e.jsx(D,{handleFollowUser:s,handleUnfollowUser:a,data:p,tab:"followers"}):e.jsx("p",{className:y.message,children:F(I,r)});case"following":return(c==null?void 0:c.length)>0?e.jsx(D,{handleFollowUser:s,handleUnfollowUser:a,data:c,tab:"following"}):e.jsx("p",{className:y.message,children:F(I,r)});default:return null}else switch(r){case"recipes":return(g==null?void 0:g.total)>0?e.jsx(M,{data:g.data}):e.jsx("p",{className:y.message,children:F(W,r)});case"followers":return(p==null?void 0:p.length)>0?e.jsx(D,{handleFollowUser:s,handleUnfollowUser:a,data:p,tab:"followers"}):e.jsx("p",{className:y.message,children:F(W,r)});default:return null}},ie=l?I:W;return e.jsxs("div",{className:y.container,ref:d,children:[e.jsx(De,{menuItems:ie,activeTab:r,setActiveTab:m}),ae?e.jsx(xe,{}):e.jsx("div",{className:y.content,children:ne()}),N>1&&e.jsx(je,{pageCount:N,onPageChange:R,currentPage:o})]})},hs="_container_1cyys_1",gs="_breadscrumbs_1cyys_5",ws="_title_1cyys_9",xs="_subtitle_1cyys_12",js="_userInfoAndBtnWrapper_1cyys_21",vs="_userInfoAndTabContentWerapper_1cyys_58",P={container:hs,breadscrumbs:gs,title:ws,subtitle:xs,userInfoAndBtnWrapper:js,userInfoAndTabContentWerapper:vs},ys="_profile_card_wrapper_td0jq_1",bs="_profile_card_td0jq_1",Cs="_profile_name_td0jq_22",Is="_profile_card_info_td0jq_31",Ns="_profile_info_item_td0jq_38",Fs="_profile_info_content_td0jq_48",Ls="_profile_big_card_button_td0jq_56",Ps="_profile_big_card_icon_td0jq_65",Rs="_profile_photo_td0jq_69",v={profile_card_wrapper:ys,profile_card:bs,profile_name:Cs,profile_card_info:Is,profile_info_item:Ns,profile_info_content:Fs,profile_big_card_button:Ls,profile_big_card_icon:Ps,profile_photo:Rs},Us=s=>s.charAt(0).toUpperCase()+s.slice(1),Ws=({name:s,value:a})=>{const t={email:"email",createdRecipesCount:"added recipes",favoriteRecipesCount:"favorites",followersCount:"followers",followingCount:"following"};return e.jsxs("li",{className:v.profile_info_item,children:[Us(t[s]),":",e.jsx("span",{className:v.profile_info_content,children:a})]})},Ss=()=>{const s=h(B),[a]=ve(),t=h(Se),n=E(),l=t?Object.keys(t):[],[p,c]=u.useState((t==null?void 0:t.avatar)||G),d=async i=>{const r=new FormData;r.append("avatar",i);try{const m=await a(r).unwrap();c(m.avatarURL),n(be(m.avatarURL))}catch(m){console.error("Error updating avatar:",m)}},_=i=>{const r=i.target.files[0];if(r){const m=new FileReader;m.onload=()=>{d(r)},m.readAsDataURL(r)}},f=u.useRef(null),[o,b]=u.useState({width:16,height:16}),N=()=>{f.current.click()};return u.useEffect(()=>{c((t==null?void 0:t.avatar)||G)},[t==null?void 0:t.avatar]),u.useEffect(()=>{const i=()=>{window.matchMedia("(max-width: 768px)").matches?b({width:16,height:16}):b({width:18,height:18})};return i(),window.addEventListener("resize",i),()=>{window.removeEventListener("resize",i)}},[]),e.jsx("div",{className:v.profile_card_wrapper,children:e.jsxs("div",{className:v.profile_card,children:[e.jsx("img",{className:v.profile_photo,src:p,alt:`${(t==null?void 0:t.name)||"User Name"} avatar`}),s&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"file",ref:f,style:{display:"none"},onChange:_}),e.jsx(k,{iconId:"icon-plus",style:v.profile_big_card_button,styleSVG:v.profile_big_card_icon,stroke:"#FFF",width:o.width,height:o.height,onClick:N})]}),e.jsx("h3",{className:v.profile_name,children:t==null?void 0:t.name}),e.jsx("ul",{className:v.profile_info,children:l.map(i=>{if(!(i==="_id"||i==="name"||i==="avatar"))return e.jsx(Ws,{name:i,value:t[i]},ye())})})]})})},S="toastId",Os=()=>{const s=h(Z),[a,t]=u.useState(!1),[n,l]=u.useState(!1),p=h(B),{id:c}=K(),d=E(),{data:_,error:f}=Ce(c),{data:o}=Ie(),[b,{error:N}]=Ne(),[i,{error:r}]=Fe(),m=w=>{if(b(w),N){U.error("Something went wrong",{toastId:S});return}d(q({...o,following:[...o.following,w]})),U.success("Follow successful",{toastId:S})},g=w=>{if(i(w),r){U.error("Something went wrong",{toastId:S});return}d(q({...o,following:o.following.filter(R=>R!==w)})),U.success("Unfollow successful",{toastId:S})};if(u.useEffect(()=>{if(c!==s&&o&&o.following){const w=o.following.some(R=>R===c);l(w)}},[o,c,s]),u.useEffect(()=>{o&&d(q(o)),_&&d(Le(_))},[_,o,d]),f){U.error(f.data.message,{toastId:S});return}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:P.container,children:[e.jsx("div",{className:P.breadscrumbs,children:e.jsx(ke,{currentPage:"Profile"})}),e.jsx("div",{className:P.title,children:e.jsx(Te,{text:"Profile"})}),e.jsxs("p",{className:P.subtitle,children:["Reveal your culinary art, share your favorite recipe and create ",e.jsx("br",{}),"gastronomic masterpieces with us."]}),e.jsxs("div",{className:P.userInfoAndTabContentWerapper,children:[e.jsxs("div",{className:P.userInfoAndBtnWrapper,children:[e.jsx(Ss,{}),p?e.jsx(z,{type:"button",variant:"logoutOrFollowBtn",text:"Log Out",onClick:()=>t(!0)}):e.jsx(z,{type:"button",variant:"logoutOrFollowBtn",text:n?"Unfollow":"Follow",onClick:n?()=>g(c):()=>m(c)})]}),e.jsx(ms,{handleFollowUser:m,handleUnfollowUser:g})]})]}),e.jsx(Pe,{isOpen:a,onClose:()=>t(!1),children:e.jsx(Re,{setModalLogOutOpen:t})})]})};export{Os as default};
